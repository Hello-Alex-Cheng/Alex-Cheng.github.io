

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Hello_AlexCc">
  <meta name="keywords" content="Full stack engineer">
  
    <meta name="description" content="0.1 + 0.2不等于0.3？ https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;6844903680362151950  JavaScript使用Number类型表示数字（整数和浮点数），遵循 IEEE754(二进制浮点数算术) 标准，通过64位来表示一个数字 本质是：二进制模拟十进制进行计算时 的精度问题 IEEE754 的存储位有限 在二进制的处理过程中有两次精度丢失问题，一次是 存储，一次是">
<meta property="og:type" content="website">
<meta property="og:title" content="page.title">
<meta property="og:url" content="http://yoursite.com/demo/2023%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/2023%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB.html">
<meta property="og:site_name" content="Hello_AlexCc">
<meta property="og:description" content="0.1 + 0.2不等于0.3？ https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;6844903680362151950  JavaScript使用Number类型表示数字（整数和浮点数），遵循 IEEE754(二进制浮点数算术) 标准，通过64位来表示一个数字 本质是：二进制模拟十进制进行计算时 的精度问题 IEEE754 的存储位有限 在二进制的处理过程中有两次精度丢失问题，一次是 存储，一次是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMjY1MDUyOC1lMjMwMjk5NjhlYjU3MmQzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwfGltYWdlVmlldzIvMi93Lzc4Ni9mb3JtYXQvd2VicA?x-oss-process=image/format,png">
<meta property="article:published_time" content="2024-06-11T08:52:17.363Z">
<meta property="article:modified_time" content="2024-06-11T08:52:17.363Z">
<meta property="article:author" content="Hello_AlexCc">
<meta property="article:tag" content="Full stack engineer">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMjY1MDUyOC1lMjMwMjk5NjhlYjU3MmQzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwfGltYWdlVmlldzIvMi93Lzc4Ni9mb3JtYXQvd2VicA?x-oss-process=image/format,png">
  
  
  <title>page.title - Hello_AlexCc</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header style="height: 60vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Hello_AlexCc</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="page.title">
              
            </span>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      <div class="container nopadding-x-md">
        <div class="py-5" id="board"
          >
          
          <div class="container">
            <div class="row">
              <div class="col-12 col-md-10 m-auto">
                

<article class="page-content">
  <h1 id="0-1-0-2不等于0-3？"><a href="#0-1-0-2不等于0-3？" class="headerlink" title="0.1 + 0.2不等于0.3？"></a>0.1 + 0.2不等于0.3？</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903680362151950">https://juejin.cn/post/6844903680362151950</a></p>
</blockquote>
<p>JavaScript使用Number类型表示数字（整数和浮点数），遵循 <code>IEEE754(二进制浮点数算术)</code> 标准，通过64位来表示一个数字</p>
<p>本质是：二进制模拟十进制进行计算时 的精度问题</p>
<p>IEEE754 的存储位有限</p>
<p>在二进制的处理过程中有两次精度丢失问题，一次是 存储，一次是相加，最终导致 <code>0.1 + 0.2 = 0.30000000000000004</code></p>
<h2 id="十进制整数转二进制"><a href="#十进制整数转二进制" class="headerlink" title="十进制整数转二进制"></a>十进制整数转二进制</h2><p>整数除2，取余数，没有余数取0</p>
<h2 id="十进制小数如何转二进制？"><a href="#十进制小数如何转二进制？" class="headerlink" title="十进制小数如何转二进制？"></a>十进制小数如何转二进制？</h2><p>十进制小数转二进制，小数部分 <code>乘 2 取整数部分</code>，若乘之后的小数部分不为 0，继续乘以 2 直到小数部分为 0 ，将取出的整数正向排序。</p>
<p><code>0.1</code> 转二进制：</p>
<figure class="highlight js"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><pre><code class="hljs js"><span class="hljs-number">0.1</span> * <span class="hljs-number">2</span> = <span class="hljs-number">0.2</span> --------------- 取整数 <span class="hljs-number">0</span>，小数 <span class="hljs-number">0.2</span><br><span class="hljs-number">0.2</span> * <span class="hljs-number">2</span> = <span class="hljs-number">0.4</span> --------------- 取整数 <span class="hljs-number">0</span>，小数 <span class="hljs-number">0.4</span><br><span class="hljs-number">0.4</span> * <span class="hljs-number">2</span> = <span class="hljs-number">0.8</span> --------------- 取整数 <span class="hljs-number">0</span>，小数 <span class="hljs-number">0.8</span><br><span class="hljs-number">0.8</span> * <span class="hljs-number">2</span> = <span class="hljs-number">1.6</span> --------------- 取整数 <span class="hljs-number">1</span>，小数 <span class="hljs-number">0.6</span><br><span class="hljs-number">0.6</span> * <span class="hljs-number">2</span> = <span class="hljs-number">1.2</span> --------------- 取整数 <span class="hljs-number">1</span>，小数 <span class="hljs-number">0.2</span><br><span class="hljs-number">0.2</span> * <span class="hljs-number">2</span> = <span class="hljs-number">0.4</span> --------------- 取整数 <span class="hljs-number">0</span>，小数 <span class="hljs-number">0.4</span><br><span class="hljs-number">0.4</span> * <span class="hljs-number">2</span> = <span class="hljs-number">0.8</span> --------------- 取整数 <span class="hljs-number">0</span>，小数 <span class="hljs-number">0.8</span><br><span class="hljs-number">0.8</span> * <span class="hljs-number">2</span> = <span class="hljs-number">1.6</span> --------------- 取整数 <span class="hljs-number">1</span>，小数 <span class="hljs-number">0.6</span><br><span class="hljs-number">0.6</span> * <span class="hljs-number">2</span> = <span class="hljs-number">1.2</span> --------------- 取整数 <span class="hljs-number">1</span>，小数 <span class="hljs-number">0.2</span><br>...<br></code></pre></td></tr></table></figure>
<p>最终 0.1 的二进制表示为 0.00110011… 后面将会 <code>0011 无限循环</code>，因此二进制无法精确的保存类似 0.1 这样的小数。<code>任何使用二进制浮点数的编程语言都有这个问题</code></p>
<p>那这样无限循环也不是办法，又该保存多少位呢？</p>
<h2 id="遵循-IEEE-754-标准。"><a href="#遵循-IEEE-754-标准。" class="headerlink" title="遵循 IEEE 754 标准。"></a>遵循 IEEE 754 标准。</h2><p>IEEE 754 常用的两种浮点数值的表示方式为：单精确度（32位）、双精确度（64位）。例如， C 语言中的 float 通常是指 IEEE 单精确度，而 double 是指双精确度。</p>
<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMjY1MDUyOC1lMjMwMjk5NjhlYjU3MmQzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwfGltYWdlVmlldzIvMi93Lzc4Ni9mb3JtYXQvd2VicA?x-oss-process=image/format,png" srcset="/img/loading.gif" lazyload />

<ul>
<li><p>符号位（位数：1）决定了一个数的正负</p>
</li>
<li><p>指数位（位数：11）决定了数值的大小</p>
</li>
<li><p>小数位（位数：52）决定了数值的精度</p>
</li>
</ul>
<p>JS 中的数字类型只有 Number 一种，而 Number 类型采用的是 IEEE 754 标准中的 <code>双精度浮点数（64位）</code> 来表示一个数字，不区分整数和浮点数。</p>
<p>所以，JS 中提供的有效位是 <code>64 - 11</code> 为 <code>53</code> 位。</p>
<p>将 <code>0.1</code> 或 <code>0.2</code> 转为二进制数时，会出现无限循环，而二进制存储结构中的小数部分，最多只能表示 53 位。为了能表示 0.1 这类小数，只能进行舍入（类似四舍五入这种），但是二进制只有 0 和 1，于是就变成了 <code>0舍1入</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 0.1</span><br><br><span class="hljs-number">0.0001100110011001100110011001100110011001100110011001101</span> <span class="hljs-comment">// 舍0，1入，最后两位变成了 01</span><br></code></pre></td></tr></table></figure>

<p>所以，在 0.1 和 0.2 进行二进制转换时，丢失了一次精度。</p>
<p>在二进制求和时，又丢失了一次精度，最终导致求和不准确 <code>0.1 + 0.2 !== 0.3</code></p>
<h2 id="JS中最大安全整数"><a href="#JS中最大安全整数" class="headerlink" title="JS中最大安全整数"></a>JS中最大安全整数</h2><p><code>IEEE754规定位数第一位隐含为1，不写。</code></p>
<p>比如我们可以通过 <code>Math.pow(2, 53) - 1</code> 拿到<code>最大</code>的安全整数，它的值和 <code>Number.Number.MAX_SAFE_INTEGER</code> 一样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Number</span>.<span class="hljs-property">MAX_SAFE_INTEGER</span> === <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">53</span>) - <span class="hljs-number">1</span><br><br><span class="hljs-title class_">Number</span>.<span class="hljs-property">MIN_SAFE_INTEGER</span> <span class="hljs-comment">// 最小</span><br></code></pre></td></tr></table></figure>

<h2 id="JS-中最大的数是什么？"><a href="#JS-中最大的数是什么？" class="headerlink" title="JS 中最大的数是什么？"></a>JS 中最大的数是什么？</h2><p><code>Infinity</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Infinity</span> ===&gt; <span class="hljs-string">&#x27;number&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ol>
<li>可以先将其转化为整数，再除以转整数时的倍数</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> res = (<span class="hljs-number">10</span>*<span class="hljs-number">0.1</span> + <span class="hljs-number">10</span>*<span class="hljs-number">0.2</span>) / <span class="hljs-number">10</span> <span class="hljs-comment">// 0.3</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>使用 <code>toFixed</code></li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-number">0.1</span>+<span class="hljs-number">0.2</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">1</span>) ===&gt; <span class="hljs-string">&#x27;0.3&#x27;</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>使用 <code>Number.EPSILON</code> 最小值比较大小</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> equal = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> - <span class="hljs-number">0.3</span>) &lt; <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span> <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>

<ol start="4">
<li>使用计算库来解决</li>
</ol>
<p><code>math.js、decimal.js</code></p>
<h1 id="JS-数据类型"><a href="#JS-数据类型" class="headerlink" title="JS 数据类型"></a>JS 数据类型</h1><p>基本类型（七中）：number, string, undefined, null, boolean, Symbol, bigint</p>
<p>引用类型：Object，对象子类型（array, function）</p>
<h1 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h1><p>事件流是网页元素接收事件的顺序，”DOM2级事件”规定的事件流包括三个阶段：<code>事件捕获阶段、处于目标阶段、事件冒泡阶段</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>    父元素<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>子元素<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> p = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;p&#x27;</span>)</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> s = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;span&#x27;</span>)</span><br><span class="language-javascript"></span><br><span class="language-javascript">    s.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;子   捕获&#x27;</span>)</span><br><span class="language-javascript">    &#125;, <span class="hljs-literal">true</span>)</span><br><span class="language-javascript">    s.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;子   冒泡&#x27;</span>)</span><br><span class="language-javascript">    &#125;, <span class="hljs-literal">false</span>)</span><br><span class="language-javascript"></span><br><span class="language-javascript">    p.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;父组件捕获&#x27;</span>)</span><br><span class="language-javascript">    &#125;, <span class="hljs-literal">true</span>)</span><br><span class="language-javascript">      p.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;父组件冒泡&#x27;</span>)</span><br><span class="language-javascript">    &#125;, <span class="hljs-literal">false</span>)</span><br><span class="language-javascript">    </span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>同时存在捕获和冒泡事件时，点击 span 元素，会打印如下，遵循事件流的执行顺序。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">父组件捕获<br>子   捕获<br>子   冒泡<br>父组件冒泡<br></code></pre></td></tr></table></figure>

<h1 id="什么是作用域"><a href="#什么是作用域" class="headerlink" title="什么是作用域"></a>什么是作用域</h1><p>作用域（Scope）是指在程序中定义<code>变量的可访问范围</code>。它规定了在哪些地方以及如何能够访问变量、函数和对象。</p>
<p>es5：全局作用域和函数作用域，es6 有了块级作用域</p>
<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><p>闭包是一种特殊的对象，它由两部分组成：执行上下文（代号 A），以及在该执行上下文中创建的函数 （代号 B），当 B 执行时，如果访问了 A 中变量对象的值，那么闭包就会产生。</p>
<p>闭包是指有权访问另外一个函数作用域中的变量的函数</p>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul>
<li><p>封装私有变量</p>
</li>
<li><p>延迟执行：使用闭包可以实现延迟执行函数，即将一个函数作为返回值返回，并在后续的某个时刻执行该函数</p>
</li>
<li><p>模块化开发：通过闭包可以创建模块化的代码结构，将相关的函数和数据封装在一个闭包内部，提供对外暴露的接口，隐藏实现的细节。</p>
</li>
<li><p>循环中的问题：在使用循环时，闭包可以解决由于 JavaScript 作用域机制导致的变量共享问题。</p>
</li>
<li><p>防抖和节流：通过闭包可以实现防抖（debounce）和节流（throttle）等常见的函数优化技术，用于控制函数的触发频率。</p>
</li>
<li><p>实现高阶函数：闭包可以用于实现高阶函数，即函数作为参数或返回值的函数。通过闭包，可以捕获并记住外部函数的上下文和状态。</p>
</li>
</ul>
<h1 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h1><p>当访问一个变量时，编译器在执行这段代码时，会首先从当前的作用域中查找是否有这个标识符，如果没有找到，就会去父作用域查找，如果父作用域还没找到继续向上查找，直到全局作用域为止</p>
<h1 id="this-的四条规则"><a href="#this-的四条规则" class="headerlink" title="this 的四条规则"></a>this 的四条规则</h1><ul>
<li>默认绑定</li>
</ul>
<p>没有其他修饰（bind、apply、call)，在非严格模式下定义指向全局对象，在严格模式下定义指向 undefined</p>
<ul>
<li>隐式绑定</li>
</ul>
<p>调用位置是否有上下文对象，或者是否被某个对象拥有或者包含，那么隐式绑定规则会把函数调用中的 this 绑定到这个上下文对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>);<br>&#125;<br><br><span class="hljs-keyword">var</span> obj = &#123;<br>  <span class="hljs-attr">a</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">foo</span>: foo,<br>&#125;<br><br>obj.<span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// 2</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p>显示绑定：通过在函数上运行 call 和 apply ，来显示的绑定 this</p>
</li>
<li><p>new 绑定</p>
</li>
</ul>
<h1 id="手写-call、apply、bind"><a href="#手写-call、apply、bind" class="headerlink" title="手写 call、apply、bind"></a>手写 call、apply、bind</h1><p>call</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myCall</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context, ...args</span>) &#123;<br>  <span class="hljs-comment">// context 就是 call 第一个参数，上下文环境</span><br>  context = <span class="hljs-keyword">typeof</span> context === <span class="hljs-string">&#x27;object&#x27;</span> ? context || <span class="hljs-variable language_">window</span> : &#123;&#125;;<br><br>  <span class="hljs-keyword">const</span> s = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;fn&#x27;</span>)<br>  context[s] = <span class="hljs-variable language_">this</span> <span class="hljs-comment">// 将方法 赋值给 context 对象,</span><br><br>  <span class="hljs-keyword">const</span> result = context[s](...args) <span class="hljs-comment">// 在目标对象上(context)调用方法，方法内部的 this 就指向 context 了</span><br><br>  <span class="hljs-keyword">delete</span> context[s] <span class="hljs-comment">// 记得删除context 上定义的方法</span><br>  <br>  <span class="hljs-keyword">return</span> result<br>&#125;<br></code></pre></td></tr></table></figure>

<p>apply 基本和 call 一样，只是参数不同，apply 接受一个数组作为参数。</p>
<p>bind 基本上和 call、apply 也很相似，只不过返回了一个函数，执行时机灵活多变。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myBind</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context, ...args</span>) &#123;<br>  context = context || <span class="hljs-variable language_">window</span><br>  <span class="hljs-keyword">const</span> s = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;fn&#x27;</span>)<br><br>  context[s] = <span class="hljs-variable language_">this</span><br><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">..._args</span>) &#123;<br>    args = args.<span class="hljs-title function_">concat</span>(_args)<br>    <span class="hljs-keyword">const</span> r = context[s](...args)<br><br>    <span class="hljs-keyword">delete</span> context[s]<br><br>    <span class="hljs-keyword">return</span> r<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="实现一个-pipe-函数"><a href="#实现一个-pipe-函数" class="headerlink" title="实现一个 pipe 函数"></a>实现一个 pipe 函数</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">square</span> = v =&gt; v * v<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">double</span> = v =&gt; v * <span class="hljs-number">2</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">addOne</span> = v =&gt; v + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">const</span> res = <span class="hljs-title function_">pipe</span>(square, double, addOne)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">res</span>(<span class="hljs-number">3</span>)) <span class="hljs-comment">// 19; addOne(double(square(3)))</span><br></code></pre></td></tr></table></figure>

<p>pipe是可以接收任意个数的函数，并且返回的是一个新的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">pipe</span>(<span class="hljs-params">...fns</span>) &#123;<br>  <br>  <span class="hljs-comment">// value 就是传入进来的数字</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> fns.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">pre, cur</span>) =&gt;</span> &#123;<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-title function_">cur</span>(pre)<br>    &#125;, value)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>由于 value 作为 reduce 的初始值，所以，第一次循环的结果是 cur(value)，也就是 square(3)</p>
<p>第二次循环时，square(3) 就是 pre，cur(pre) 就是 <code>double(square(3))</code>，以此类推…</p>
<h1 id="如何判断一个对象是不是空对象"><a href="#如何判断一个对象是不是空对象" class="headerlink" title="如何判断一个对象是不是空对象"></a>如何判断一个对象是不是空对象</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj).<span class="hljs-property">length</span> === <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>
<p>JSON.stringify 不能用来判断是不是空对象，因为如果属性值是 function 或者 undefined，序列化出来之后会丢失这两个属性</p>
<h1 id="扁平化一个数组"><a href="#扁平化一个数组" class="headerlink" title="扁平化一个数组"></a>扁平化一个数组</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, [<span class="hljs-number">4</span>, [ <span class="hljs-number">5</span> ]]]]<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">const</span> result = []<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr[i])) &#123;<br>      result.<span class="hljs-title function_">push</span>(...<span class="hljs-title function_">flatten</span>(arr[i]))<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      result.<span class="hljs-title function_">push</span>(arr[i])<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> result<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">flatten</span>(arr))<br></code></pre></td></tr></table></figure>

<h1 id="排序-冒泡-O-n-2"><a href="#排序-冒泡-O-n-2" class="headerlink" title="排序-冒泡 O(n^2)"></a>排序-冒泡 O(n^2)</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">99</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">5</span>]<br><br><span class="hljs-comment">// 冒泡</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bubbleSort</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> length = arr.<span class="hljs-property">length</span><br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt; length - i; j++) &#123;<br>      <span class="hljs-keyword">if</span> (arr[j] &lt; arr[j - <span class="hljs-number">1</span>]) &#123;<br>        <span class="hljs-comment">// const temp = arr[j]</span><br>        <span class="hljs-comment">// arr[j] = arr[j - 1]</span><br>        <span class="hljs-comment">// arr[j - 1] = temp</span><br><br>        [arr[j], arr[j - <span class="hljs-number">1</span>]] = [arr[j - <span class="hljs-number">1</span>], arr[j]]<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> arr<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">bubbleSort</span>(arr))<br></code></pre></td></tr></table></figure>

<h1 id="排序-选择排序-O-n-2"><a href="#排序-选择排序-O-n-2" class="headerlink" title="排序-选择排序 O(n^2)"></a>排序-选择排序 O(n^2)</h1><p>假设数组第一个元素就是最小的值，双循环遍历数组，找到可能存在最小的值，和假定的最小值交换位置</p>
<p>第二层循环 j = i，表示已经排序了的，不需要再遍历查找了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">selectSort</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> minIndex<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-comment">// 假设一个最小的值</span><br>    minIndex = i<br><br>    <span class="hljs-comment">// 让 j = i，表示前面已经排序了的，就不需要再排了</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i; j &lt; arr.<span class="hljs-property">length</span>; j ++) &#123;<br>      <span class="hljs-comment">// 一轮下来，肯定能找到一个最小值 index</span><br>      <span class="hljs-keyword">if</span> (arr[j] &lt; arr[minIndex]) &#123;<br>        minIndex = j<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 如果 minIndex !== i，表示存在比arr[minIndex]还小的值 arr[i]，和 i 进行交换</span><br>    <span class="hljs-keyword">if</span> (minIndex !== i) &#123;<br>      [arr[minIndex], arr[i]] = [arr[i], arr[minIndex]]<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> arr<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="排序-插入排序"><a href="#排序-插入排序" class="headerlink" title="排序-插入排序"></a>排序-插入排序</h1><p>arr = [3, 2, 1, 6, 1, 99, 0, -1, 5]</p>
<ol>
<li><p>默认第一项是排序了的，所以遍历时从数组下标为 1 的位置开始</p>
</li>
<li><p>用 for 循环将当前遍历的项存储起来，current，并记录当前项的下标currentIndex</p>
</li>
<li><p>通过 while 循环，current 前面的项 和 current 比较</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">insertSort</span>(<span class="hljs-params">arr</span>) &#123;<br>  <span class="hljs-keyword">let</span> current, currentIndex <span class="hljs-comment">// 当前项, 当前项下标</span><br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br><br>    current = arr[i] <br>    currentIndex = i<br><br>    <span class="hljs-comment">// 让当前项的前面的每一项和当前项 current 比较，</span><br>    <span class="hljs-keyword">while</span> (currentIndex &gt; <span class="hljs-number">0</span> &amp;&amp; arr[currentIndex - <span class="hljs-number">1</span>] &gt; current) &#123;<br>      arr[currentIndex] = arr[currentIndex - <span class="hljs-number">1</span>]<br>      currentIndex--<br>    &#125;<br><br>    <span class="hljs-comment">// currentIndex = 0</span><br>    arr[currentIndex] = current<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> arr<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>第一轮</code>：</p>
<p>arr = [3, 2, 1, 6, 1, 99, 0, -1, 5]</p>
<p>current = 2, currentIndex = 1</p>
<p>current 前一项<code>arr[currentIndex - 1] = 3</code>比 current = 2 大，那就让当前项 arr[currentIndex] 等于前一项，相当于大数字往后挪了一位，[3, 3, 1, 6 …]</p>
<p>然后 currentIndex– = 0，currentIndex &gt; 0 不成立，结束 while，此时前两项是 [3, 3]</p>
<p>最后，currentIndex = 0，需要让当前项（小值）插入到正确✅的位置</p>
<p>arr[currentIndex] = current，前两项就排好序了 [2,3]</p>
<p><code>第二轮</code></p>
<p>arr = [2, 3, 1, 6, 1, 99, 0, -1, 5]</p>
<p>current = 1, currentIndex = 2</p>
<p>current 的前一项 <code>arr[currentIndex - 1] = 3</code> 比 current = 1 大，需要将大的往后挪一位，arr[currentIndex: 2] = arr[currentIndex - 1]，[2, 3, 1] =&gt; [2, 3, 3]</p>
<p>然后 currentIndex– = 1，还要判断前面的项，是不是有比 current 大的数值，arr[currentIndex-1] &gt; current （2 &gt; 1）成立，所以将大的数值往后挪一位 [2, 3, 3] =&gt; [2, 2, 3]</p>
<p>currentIndex– = 0，此时 currentIndex 等于 0，不符合 while 循环的条件了，退出</p>
<p>最后，我们需要将小的值插入到正确✅的位置：arr[currentIndex: 0] = current(1)  =&gt; [1, 2, 3 …]</p>
<p>…</p>
<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><p>最好的情况是，arr 本来就是有序的，所以每一次循环，都只需要比较一次，并且不需要交换位置，时间复杂度是 O(n - 1) ====&gt; 去掉常量就是 O(n)</p>
<p>最坏的情况是，arr 是逆序的，每一次比较，都需要将前面的每一项都挪一下位置，并且将当前项插入到数组的头部，此时复杂度是 <code>O(n^2)</code></p>
<p>空间复杂度是 <code>O(1)</code></p>
<h1 id="meta-标签：自动刷新-跳转"><a href="#meta-标签：自动刷新-跳转" class="headerlink" title="meta 标签：自动刷新/跳转"></a>meta 标签：自动刷新/跳转</h1><p>假设要实现一个类似 PPT 自动播放的效果，你很可能会想到使用 JavaScript 定时器控制页面跳转来实现。但其实有更加简洁的实现方法，比如通过 meta 标签来实现：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Refresh&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;5; URL=page2.html&quot;</span>&gt;</span> <br></code></pre></td></tr></table></figure>
<p>上面的代码会在 5s 之后自动跳转到同域下的 page2.html 页面。我们要实现 PPT 自动播放的功能，只需要在每个页面的 meta 标签内设置好下一个页面的地址即可。</p>
<p>另一种场景，比如每隔一分钟就需要<code>刷新页面</code>的大屏幕监控，也可以通过 meta 标签来实现，只需去掉后面的 URL 即可：</p>
<meta http-equiv="Refresh" content="60">

<h1 id="跟跨域相关的几个请求头含义是什么？"><a href="#跟跨域相关的几个请求头含义是什么？" class="headerlink" title="跟跨域相关的几个请求头含义是什么？"></a>跟跨域相关的几个请求头含义是什么？</h1><p>在跨域请求中，以下是几个常见的与跨域相关的请求头及其含义：</p>
<ol>
<li><p><strong>Origin</strong>: 该请求头指示了请求的来源，包含了协议、域名和端口号。它通常由浏览器自动添加，并用于表示当前页面的域和协议。在跨域请求中，服务器可以通过检查该请求头来确定是否允许跨域访问。</p>
</li>
<li><p><strong>Access-Control-Request-Method</strong>: 当浏览器发起跨域的 HTTP 预检请求（OPTIONS 请求）时，该头部用于指示实际请求所使用的方法（如 GET、POST、PUT 等）。服务器可以根据该头部来判断是否允许实际请求的方法。</p>
</li>
<li><p><strong>Access-Control-Request-Headers</strong>: 当浏览器发起跨域的 HTTP 预检请求时，该头部用于指示实际请求所携带的自定义请求头。服务器可以根据该头部来判断是否允许实际请求携带这些自定义请求头。</p>
</li>
<li><p><strong>Access-Control-Allow-Origin</strong>: 该响应头用于指示服务器是否允许来自特定源的跨域请求。当服务器接收到跨域请求时，可以通过设置该头部来告知浏览器是否允许访问。可以设置为具体的域名或 <code>*</code>（表示允许所有域名），以控制跨域访问的权限。</p>
</li>
<li><p><strong>Access-Control-Allow-Methods</strong>: 该响应头用于指示服务器允许的跨域请求方法。服务器可以通过设置该头部来告知浏览器所允许的请求方法，以控制跨域请求的权限。</p>
</li>
<li><p><strong>Access-Control-Allow-Headers</strong>: 该响应头用于指示服务器允许的跨域请求头。服务器可以通过设置该头部来告知浏览器所允许的请求头，以控制跨域请求携带自定义头部的权限。</p>
</li>
</ol>
<p>这些请求头和响应头是跨域请求中常见的一些标准头部，用于在浏览器和服务器之间进行跨域访问的协商和控制。它们的作用是确保跨域请求的安全性和权限控制。</p>
<h1 id="ES6-的-map-和-Object-有什么区别？"><a href="#ES6-的-map-和-Object-有什么区别？" class="headerlink" title="ES6 的 map 和 Object 有什么区别？"></a>ES6 的 map 和 Object 有什么区别？</h1><p>ES6中的Map和Object都是用于存储和操作数据的集合，但它们有以下几个主要区别：</p>
<ol>
<li><p>键的类型：Object的键只能是<code>字符串或符号</code>，而<code>Map的键可以是任意数据类型，包括原始类型和引用类型</code>。</p>
</li>
<li><p>键值对的顺序：Map会按照插入顺序维护键值对的顺序，而Object不会保留插入顺序，它是基于哈希表实现的。</p>
</li>
<li><p>大小获取：Map有size属性可以获取键值对的数量，而Object没有内置的属性或方法可以直接获取键值对的数量，需要手动计算。</p>
</li>
<li><p>迭代遍历：Map提供了迭代器（Iterator）可以用于遍历键值对，包括for…of循环、forEach方法等，而Object需要使用Object.keys()、Object.values()或者for…in循环来遍历属性和值。</p>
</li>
<li><p>作为键的唯一性：Map中可以使用引用类型作为键，并且它们的引用不同也会被视为不同的键，而Object中使用的键会被转换为字符串，如果键的类型不是字符串或符号，会自动转换为字符串形式。</p>
</li>
<li><p>内存占用：由于Map的实现方式不同于Object，它在处理大量键值对时通常比Object占用更多的内存。</p>
</li>
</ol>
<p>基于上述区别，选择使用Map还是Object取决于具体的需求。如果需要保持插入顺序、需要使用非字符串键或需要更灵活的键值对操作，可以选择使用Map。如果只需要简单的键值对映射、不关心顺序，或者键是字符串类型，可以使用Object。</p>
<h1 id="一个盒子（div）从中间开始，碰到最左边的边界后往右移动，碰到最右边的边界后往左移动，这个怎么实现呢？"><a href="#一个盒子（div）从中间开始，碰到最左边的边界后往右移动，碰到最右边的边界后往左移动，这个怎么实现呢？" class="headerlink" title="一个盒子（div）从中间开始，碰到最左边的边界后往右移动，碰到最右边的边界后往左移动，这个怎么实现呢？"></a>一个盒子（div）从中间开始，碰到最左边的边界后往右移动，碰到最右边的边界后往左移动，这个怎么实现呢？</h1><p><code>&lt;div class=&quot;box&quot;&gt;&lt;/div&gt;</code></p>
<p>css 实现方式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.box</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">background-color</span>: red;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;<br>  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);<br>  <span class="hljs-attribute">animation</span>: moveBox <span class="hljs-number">1s</span> infinite linear;<br>&#125;<br><br><span class="hljs-keyword">@keyframes</span> moveBox &#123;<br>  <span class="hljs-number">0%</span> &#123;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);<br>  &#125;<br>  <span class="hljs-number">50%</span> &#123;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">50px</span>));<br>  &#125;<br>  <span class="hljs-number">100%</span> &#123;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>js 实现方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.box&#x27;</span>);<br><span class="hljs-keyword">const</span> viewportWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>; <span class="hljs-comment">// 拿到窗口的宽度</span><br><span class="hljs-keyword">const</span> boxWidth = box.<span class="hljs-property">offsetWidth</span>; <span class="hljs-comment">// 盒子宽度</span><br><br><span class="hljs-keyword">let</span> direction = <span class="hljs-number">10</span>; <span class="hljs-comment">// 移动方向，1表示向右，-1表示向左</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">moveBox</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> boxLeft = box.<span class="hljs-property">offsetLeft</span>; <span class="hljs-comment">// 拿到盒子与左边界的距离</span><br>  <br>  <span class="hljs-keyword">if</span> (boxLeft &lt;= <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-comment">// 碰到最左边的边界，改变移动方向为向右</span><br>    direction = <span class="hljs-number">10</span>;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (boxLeft + boxWidth &gt;= viewportWidth) &#123;<br>    <span class="hljs-comment">// 碰到最右边的边界，改变移动方向为向左</span><br>    direction = -<span class="hljs-number">10</span>;<br>  &#125;<br>  <br>  <span class="hljs-comment">// 当 direction 数值为 1，left 会不停的 +1，向右移动</span><br>  box.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">$&#123;boxLeft + direction&#125;</span>px`</span>;<br>  <br>  <span class="hljs-title function_">requestAnimationFrame</span>(moveBox);<br>&#125;<br><br><span class="hljs-title function_">moveBox</span>();<br></code></pre></td></tr></table></figure>

<h1 id="requestAnimationFrame-和-setInterval-有什么区别"><a href="#requestAnimationFrame-和-setInterval-有什么区别" class="headerlink" title="requestAnimationFrame 和 setInterval 有什么区别?"></a>requestAnimationFrame 和 setInterval 有什么区别?</h1><p>window.requestAnimationFrame() 告诉浏览器——你希望执行一个动画，并且要求浏览器在<code>下次重绘之前</code>调用指定的回调函数更新动画。</p>
<p>该方法需要传入一个回调函数作为参数，该回调函数会<code>在浏览器下一次重绘之前执行</code>。</p>
<p>回调函数执行次数通常是每秒 60 次，但在大多数遵循 W3C 建议的浏览器中，回调函数执行次数通常与浏览器屏幕刷新次数相匹配。</p>
<ul>
<li>返回值</li>
</ul>
<p>一个 long 整数，请求 ID，是回调列表中唯一的标识。是个非零值，没有别的意义。你可以传这个值给 <code>window.cancelAnimationFrame()</code> 以取消回调函数请求。</p>
<ul>
<li>和 setInterval 区别</li>
</ul>
<ol>
<li><p>调用频率：<code>requestAnimationFrame</code>会根据浏览器的刷新频率进行调用，通常为每秒60次（60fps）。而<code>setInterval</code>则是按照设定的时间间隔进行调用。</p>
</li>
<li><p>动画性能：<code>requestAnimationFrame</code>在动画效果中具有更好的性能表现。它能够在浏览器的重绘之前执行回调函数，保证在合适的时机更新动画，避免造成过度绘制或不连续的动画效果。而<code>setInterval</code>则可能在浏览器重绘之间执行回调，导致动画不稳定或出现抖动。</p>
</li>
<li><p>暂停和恢复：使用<code>requestAnimationFrame</code>可以方便地暂停和恢复动画。通过控制回调函数的执行与否，可以在需要时停止动画，在恢复时重新启动动画。而使用<code>setInterval</code>时，如果需要暂停动画，需要清除定时器，并在恢复时重新设置定时器。</p>
</li>
<li><p>节省资源：由于<code>requestAnimationFrame</code>的调用频率与浏览器的刷新频率相匹配，因此它比<code>setInterval</code>更有效地利用了系统资源。它能够避免不必要的计算和绘制，提高页面性能和电池寿命。</p>
</li>
</ol>
<p>如果要实现动画效果，尤其是在性能要求较高的情况下，推荐使用<code>requestAnimationFrame</code>。而<code>setInterval</code>适用于一些简单的定时任务，不涉及精确的动画效果。</p>
<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><h2 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h2><p>Promise.all() 方法接收一个 promise 的 iterable 类型（注：Array，Map，Set 都属于 ES6 的 iterable 类型）的输入，并且只返回一个Promise实例，那个输入的所有 promise 的 resolve 回调的结果是一个数组。</p>
<p>这个Promise的 <code>resolve 回调执行是在所有输入的 promise 的 resolve 回调都结束</code>，或者输入的 iterable 里没有 promise 了的时候。</p>
<p>它的 reject 回调执行时，只要任何一个输入的 promise 的 reject 回调执行或者输入不合法的 promise 就会立即抛出错误，并且 reject 的是第一个抛出的错误信息。</p>
<p><code>失败/拒绝（Rejection）： 如果传入的 promise 中有一个失败（rejected），Promise.all 异步地将失败的那个结果给失败状态的回调函数，而不管其他 promise 是否完成。</code></p>
<h2 id="Promise-allSettled"><a href="#Promise-allSettled" class="headerlink" title="Promise.allSettled"></a>Promise.allSettled</h2><p>Promise.allSettled() 方法以 promise 组成的可迭代对象作为输入，并且返回一个 Promise 实例。当输入的所有 promise 都已敲定时（包括传递空的可迭代类型），返回的 promise 将兑现，并带有描述每个 promsie 结果的对象数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">333</span>);<br><span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(reject, <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;foo&#x27;</span>));<br><span class="hljs-keyword">const</span> promises = [promise1, promise2, <span class="hljs-number">3</span>];<br><br><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(r))<br>&#125;)<br><br><span class="hljs-comment">// =====&gt; 输出</span><br><br>&gt; <span class="hljs-title class_">Object</span> &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;fulfilled&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">333</span> &#125;<br>&gt; <span class="hljs-title class_">Object</span> &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;rejected&quot;</span>, <span class="hljs-attr">reason</span>: <span class="hljs-string">&quot;foo&quot;</span> &#125;<br>&gt; <span class="hljs-title class_">Object</span> &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;fulfilled&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">3</span> &#125;<br></code></pre></td></tr></table></figure>

<p>跟 all 的区别就是，即使有 promise reject，也会返回所有的 promise 集合。</p>
<h2 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race()"></a>Promise.race()</h2><p>Promise.race(iterable) 方法返回一个 promise，<code>一旦迭代器中的某个 promise 解决或拒绝，返回的 promise 就会解决或拒绝。</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">500</span>, <span class="hljs-string">&quot;one&quot;</span>);<br>&#125;);<br><span class="hljs-keyword">var</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>, <span class="hljs-string">&quot;two&quot;</span>);<br>&#125;);<br><br><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([p1, p2]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// &quot;two&quot;</span><br>  <span class="hljs-comment">// 两个都完成，但 p2 更快</span><br>&#125;);<br><br><span class="hljs-keyword">var</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>, <span class="hljs-string">&quot;three&quot;</span>);<br>&#125;);<br><span class="hljs-keyword">var</span> p4 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(reject, <span class="hljs-number">500</span>, <span class="hljs-string">&quot;four&quot;</span>);<br>&#125;);<br><br><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([p3, p4]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// &quot;three&quot;</span><br>  <span class="hljs-comment">// p3 更快，所以它完成了</span><br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) &#123;<br>  <span class="hljs-comment">// 未被调用</span><br>&#125;);<br><br><span class="hljs-keyword">var</span> p5 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">500</span>, <span class="hljs-string">&quot;five&quot;</span>);<br>&#125;);<br><span class="hljs-keyword">var</span> p6 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(reject, <span class="hljs-number">100</span>, <span class="hljs-string">&quot;six&quot;</span>);<br>&#125;);<br><br><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([p5, p6]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-comment">// 未被调用</span><br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reason); <span class="hljs-comment">// &quot;six&quot;</span><br>  <span class="hljs-comment">// p6 更快，所以它失败了</span><br>&#125;);<br></code></pre></td></tr></table></figure>

<h1 id="如何实现一个最多能并发执行-n-个-promise-的队列？"><a href="#如何实现一个最多能并发执行-n-个-promise-的队列？" class="headerlink" title="如何实现一个最多能并发执行 n 个 promise 的队列？"></a>如何实现一个最多能并发执行 n 个 promise 的队列？</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PromiseSchedule</span> &#123;<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">max</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span> = []<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span> = max <span class="hljs-comment">// 并发数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workingNum</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// 当前正在执行的数量</span><br>  &#125;<br><br>  <span class="hljs-title function_">add</span>(<span class="hljs-params">cb</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">push</span>(cb)<br>  &#125;<br><br>  <span class="hljs-title function_">start</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>; i++) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doNext</span>()<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-title function_">doNext</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">workingNum</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">workingNum</span>++<br>      <span class="hljs-comment">// 取出来执行</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">shift</span>()().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workingNum</span>--<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doNext</span>()<br>      &#125;)<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">timeout</span> = (<span class="hljs-params">time, value</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time, value))<br><br><br><span class="hljs-keyword">const</span> scheduler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PromiseSchedule</span>(<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">addTask</span> = (<span class="hljs-params">time, value</span>) =&gt; &#123;<br>  scheduler.<span class="hljs-title function_">add</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">timeout</span>(time, value).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;打印: &#x27;</span>, res)<br>  &#125;))<br>&#125;<br><br><span class="hljs-title function_">addTask</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">1</span>)<br><span class="hljs-title function_">addTask</span>(<span class="hljs-number">300</span>, <span class="hljs-number">2</span>)<br><span class="hljs-title function_">addTask</span>(<span class="hljs-number">500</span>, <span class="hljs-number">3</span>)<br><span class="hljs-title function_">addTask</span>(<span class="hljs-number">400</span>, <span class="hljs-number">4</span>)<br><br>scheduler.<span class="hljs-title function_">start</span>()<br></code></pre></td></tr></table></figure>

<p>这里设置的 2 并发数量，一次只能执行两个任务。</p>
<p>第一次 [1(1000ms), 2(300ms)]入列，执行 300ms 输出 <code>2</code>，3(500ms) 入列</p>
<p>第二次 [1(1000ms), 3(500ms)]，到了800ms，执行输出 <code>3</code>，4(400ms)入列</p>
<p>第三次 [1(1000ms), 4(400ms)]，到了1000ms，执行输出 <code>1</code>，还剩 [4(400ms)]</p>
<p>最后 输出 <code>4</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11f4y117qp/?buvid=ZC4FC9C58F2FDB43474B9C7695F094F5775B&is_story_h5=false&mid=aM0ztGKKOVLNW6aEI4XR9g%3D%3D&p=1&plat_id=115&share_from=ugc&share_medium=iphone&share_plat=ios&share_session_id=61DE28B0-C85F-4F2A-B026-11F2669BF824&share_source=WEIXIN&share_tag=s_i&timestamp=1685641196&unique_k=rJ6f0S1&up_id=355995969">介绍</a></p>
</blockquote>
<p><code>使用 Promise.race 处理</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">asyncFn</span> (timeout) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(r, timeout, timeout);<br>  &#125;)<br>&#125;<br><br><span class="hljs-keyword">const</span> tasks = [<br>  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">asyncFn</span>(<span class="hljs-number">1000</span>),<br>  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">asyncFn</span>(<span class="hljs-number">4000</span>),<br>  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">asyncFn</span>(<span class="hljs-number">2000</span>),<br>  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">asyncFn</span>(<span class="hljs-number">3000</span>),<br>]<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">limitRequest</span>(<span class="hljs-params">tasks, limit = <span class="hljs-number">2</span></span>) &#123;<br>  <span class="hljs-keyword">const</span> taskPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>() <span class="hljs-comment">// 主要是为了使用集合的操作方法 delete</span><br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> task <span class="hljs-keyword">of</span> tasks) &#123;<br>    <span class="hljs-keyword">const</span> promise = <span class="hljs-title function_">task</span>()<br>    taskPool.<span class="hljs-title function_">add</span>(promise)<br>    promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;2&#x27;</span>, res)<br>      taskPool.<span class="hljs-title function_">delete</span>(promise)<br>    &#125;)<br><br>    <span class="hljs-keyword">if</span> (taskPool.<span class="hljs-property">size</span> &gt;= limit) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)<br>      <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>(taskPool)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// 让 limitRequest 的 .then 最后执行</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(taskPool)<br>&#125;<br><br><span class="hljs-title function_">limitRequest</span>(tasks)<br></code></pre></td></tr></table></figure>

<h1 id="串行执行多个-promise"><a href="#串行执行多个-promise" class="headerlink" title="串行执行多个 promise"></a>串行执行多个 promise</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params">res = <span class="hljs-number">0</span></span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)<br>      <span class="hljs-title function_">r</span>(<span class="hljs-number">11</span> + res)<br>    &#125;, <span class="hljs-number">1000</span>)<br>  &#125;)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">list</span>) &#123;<br>  <span class="hljs-comment">// 递归</span><br>  <span class="hljs-comment">// const f = list.shift()</span><br>  <span class="hljs-comment">// if (f) &#123;</span><br>  <span class="hljs-comment">//   f().then(res =&gt; &#123;</span><br>  <span class="hljs-comment">//     console.log(res)</span><br>  <span class="hljs-comment">//     run(list)</span><br>  <span class="hljs-comment">//   &#125;)</span><br>  <span class="hljs-comment">// &#125;</span><br>  <br>  <span class="hljs-comment">// 循环</span><br>  <span class="hljs-comment">// 首先创建一个初始值为 resolved 状态的 Promise 对象 promise，</span><br>  <span class="hljs-comment">// 每次将当前 Promise 对象和下一个函数 fn 组合成一个新的 Promise 对象，</span><br>  <span class="hljs-comment">// 并将其赋值给 promise。</span><br>  <span class="hljs-comment">// 这样，每次循环都会生成一个新的 Promise 对象</span><br>  <span class="hljs-comment">// 它的状态取决于上一个 Promise 对象和当前函数的执行结果。</span><br>  <span class="hljs-comment">// 最后返回的是最后一个 Promise 对象，它的状态取决于所有函数的执行结果。</span><br>  <span class="hljs-comment">// 这个函数的作用是实现 Promise 链式调用</span><br>  <span class="hljs-comment">// 可以方便地处理多个异步操作的依赖关系。</span><br>  <span class="hljs-keyword">let</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">0</span>)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(promise)<br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> fn <span class="hljs-keyword">of</span> list) &#123;<br>    promise = promise.<span class="hljs-title function_">then</span>(fn)<br>  &#125;<br>  <span class="hljs-keyword">return</span> promise<br>&#125;<br><br><span class="hljs-title function_">run</span>([fn, fn, fn, fn])<br><br></code></pre></td></tr></table></figure>

<h1 id="翻转单链表"><a href="#翻转单链表" class="headerlink" title="翻转单链表"></a>翻转单链表</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义两个变量</span><br><br><span class="hljs-keyword">const</span> head = <span class="hljs-title class_">NodeList</span><br><br><span class="hljs-keyword">let</span> prev = <span class="hljs-literal">null</span> <span class="hljs-comment">// 用来充当末尾节点</span><br><span class="hljs-keyword">let</span> curr = head <span class="hljs-comment">// 让 curr 指向 head</span><br><br><span class="hljs-keyword">while</span>(curr) &#123;<br>  head = curr<br><br>  curr = curr.<span class="hljs-property">next</span> <span class="hljs-comment">// 移动 curr</span><br><br>  head.<span class="hljs-property">next</span> = prev <span class="hljs-comment">// 执行翻转</span><br><br>  prev = head<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="cache设计"><a href="#cache设计" class="headerlink" title="cache设计"></a>cache设计</h1><p>题目描述</p>
<p>设计一个对象cache，它支持下列两个基本操作：<br>set(id, object)，根据 id 设置对象；<br>get(id)：根据id得到一个对象</p>
<p>同时它有下面几个性质：</p>
<ol>
<li>x秒自动过期，如果cache内的对象，x秒内没有被get或者set过，则会自动过期</li>
<li>对象数限制，该cache可以设置一个n，表示cache最多能存储的对象数；</li>
<li>LRU置换，当进行set操作时，如果此时 cache内对象数已经到达了n个，则cache自动将最久未被使用过的那个对象剔除，腾出空间放置新对象；</li>
</ol>
<p>请你设计这样一个cache ！</p>
<h1 id="对版本号从小到大进行排序"><a href="#对版本号从小到大进行排序" class="headerlink" title="对版本号从小到大进行排序"></a>对版本号从小到大进行排序</h1><p>sort 的 compareFn(a, b) 返回值表示 <code>排序顺序</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">&gt; <span class="hljs-number">0</span>	a 在 b 后，如 [b, a]，升序排列<br>&lt; <span class="hljs-number">0</span>	a 在 b 前，如 [a, b]<br>=== <span class="hljs-number">0</span>	保持 a 和 b 原来的顺序<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> versions = [<span class="hljs-string">&#x27;1.45.1&#x27;</span>, <span class="hljs-string">&#x27;1.5&#x27;</span>, <span class="hljs-string">&#x27;1.3.2&#x27;</span>, <span class="hljs-string">&#x27;3.3.3.3&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>];<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">compareVersions</span>(<span class="hljs-params">version1, version2</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(version1, version2)<br>  <span class="hljs-keyword">const</span> nums1 = version1.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);<br>  <span class="hljs-keyword">const</span> nums2 = version2.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);<br>  <br>  <span class="hljs-keyword">const</span> maxLength = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(nums1.<span class="hljs-property">length</span>, nums2.<span class="hljs-property">length</span>);<br>  <br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; maxLength; i++) &#123;<br>    <span class="hljs-keyword">const</span> num1 = nums1[i] || <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">const</span> num2 = nums2[i] || <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">if</span> (num1 &lt; num2) &#123;<br>      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num1 &gt; num2) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">const</span> sortedVersions = versions.<span class="hljs-title function_">sort</span>(compareVersions);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sortedVersions);<br><br></code></pre></td></tr></table></figure>

<h1 id="给定一个字符串-str-39-a-b-c-39-，获取对象的值"><a href="#给定一个字符串-str-39-a-b-c-39-，获取对象的值" class="headerlink" title="给定一个字符串 str = &#39;a.b.c&#39;，获取对象的值"></a>给定一个字符串 <code>str = &#39;a.b.c&#39;</code>，获取对象的值</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> obj = &#123;<br>  <span class="hljs-attr">a</span>: &#123;<br>    <span class="hljs-attr">b</span>: &#123;<br>      <span class="hljs-attr">c</span>: <span class="hljs-string">&#x27;hello world&#x27;</span><br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;a.b.c&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getValue</span>(<span class="hljs-params">str</span>) &#123;<br>  <span class="hljs-keyword">const</span> keys = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>)<br>  <span class="hljs-keyword">let</span> curr = obj<br><br>  <span class="hljs-keyword">while</span> (keys.<span class="hljs-property">length</span>) &#123;<br>    curr = curr[keys.<span class="hljs-title function_">shift</span>()]<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> curr<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getValue</span>(str))<br></code></pre></td></tr></table></figure>

<h1 id="Vue2-里面的-sync"><a href="#Vue2-里面的-sync" class="headerlink" title="Vue2 里面的 .sync"></a>Vue2 里面的 .sync</h1><p>实现父子组件之间数据的双向绑定，与 v-model 类似，主要是为了简化操作流程</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;base-checkbox key=<span class="hljs-string">&quot;1&quot;</span> :msg.<span class="hljs-property">sync</span>=<span class="hljs-string">&quot;msg&quot;</span> :msg1.<span class="hljs-property">sync</span>=<span class="hljs-string">&quot;msg1&quot;</span> /&gt;<br><br><span class="hljs-comment">// base-checkbox 组件内部</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><br><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;msg&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">  @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;$emit(&#x27;update:msg&#x27;, $event.target.value)&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">/&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>我们修改 input 的内容，能够实时反应到父组件的数据。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;editor&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 实时更新 msg msg1 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123;msg1&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">base-checkbox</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">:msg.sync</span>=<span class="hljs-string">&quot;msg&quot;</span> <span class="hljs-attr">:msg1.sync</span>=<span class="hljs-string">&quot;msg1&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&quot;base-checkbox&quot;</span>, &#123;</span><br><span class="language-javascript">      <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">msg</span>: <span class="hljs-title class_">String</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">msg1</span>: <span class="hljs-title class_">String</span></span><br><span class="language-javascript">      &#125;,</span><br><span class="language-javascript">      <span class="hljs-attr">template</span>: <span class="hljs-string">`</span></span><br><span class="hljs-string"><span class="language-javascript">        &lt;div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">          &lt;input</span></span><br><span class="hljs-string"><span class="language-javascript">            :value=&quot;msg&quot;</span></span><br><span class="hljs-string"><span class="language-javascript">            @input=&quot;$emit(&#x27;update:msg&#x27;, $event.target.value)&quot;</span></span><br><span class="hljs-string"><span class="language-javascript">          /&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">          &lt;input</span></span><br><span class="hljs-string"><span class="language-javascript">            :value=&quot;msg1&quot;</span></span><br><span class="hljs-string"><span class="language-javascript">            @input=&quot;$emit(&#x27;update:msg1&#x27;, $event.target.value)&quot;</span></span><br><span class="hljs-string"><span class="language-javascript">          /&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">        &lt;/div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">      `</span></span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">      <span class="hljs-attr">el</span>: <span class="hljs-string">&quot;#editor&quot;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">data</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;msg&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">msg1</span>: <span class="hljs-string">&quot;msg1&quot;</span></span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="Vue中-setTimout-dom渲染-nextTick"><a href="#Vue中-setTimout-dom渲染-nextTick" class="headerlink" title="Vue中 setTimout/dom渲染/$nextTick"></a>Vue中 setTimout/dom渲染/$nextTick</h1><h2 id="在created中更改数据"><a href="#在created中更改数据" class="headerlink" title="在created中更改数据"></a>在created中更改数据</h2><p>不会触发 beforeUpdate 和 updated 钩子函数</p>
<p>created 钩子函数执行的时候，Vue 实例已经创建，data 数据已经挂载，但是 DOM 还没有生成。beforeUpdate 和 updated 钩子函数是在数据改变导致的虚拟 DOM 重新渲染和打补丁时被调用的，也就是说这两个钩子函数是在 DOM 生成之后才会被调用的。所以在 created 钩子函数中修改数据，DOM 还没有生成，自然就不会触发 beforeUpdate 和 updated 钩子函数了。</p>
<h2 id="beforeUpdate-updated-nextTick"><a href="#beforeUpdate-updated-nextTick" class="headerlink" title="beforeUpdate/updated/nextTick"></a>beforeUpdate/updated/nextTick</h2><p>都是微任务</p>
<p>更新过程是：微任务 -&gt; dom渲染（微任务） -&gt; 宏任务</p>
<h2 id="dom渲染"><a href="#dom渲染" class="headerlink" title="dom渲染"></a>dom渲染</h2><p>Vue 的 DOM 更新操作是微任务。Vue 使用了一个叫做异步队列的机制，当数据发生变化时，Vue 会开启一个异步队列，并将所有的数据改变都推入这个队列。然后在下一个事件循环 “tick” 中，Vue 刷新队列并执行实际（已去重的）工作。Vue 在内部对异步队列尝试使用原生的 Promise.then、MutationObserver 和 setImmediate，如果执行环境不支持，则会采用 setTimeout(fn, 0) 代替。</p>
<h2 id="setTimout中修改数据并使用nextTick的问题"><a href="#setTimout中修改数据并使用nextTick的问题" class="headerlink" title="setTimout中修改数据并使用nextTick的问题"></a>setTimout中修改数据并使用nextTick的问题</h2><p>在调用nextTick之前，修改数据，$nextTick能够拿到最新的 dom</p>
<p>当nextTick在 setTimout 内部的最前面使用，再修改数据，nextTick无法拿到最新的 dom</p>
<p><code>原因</code></p>
<p>在不加 setTimeout 包裹的情况下，无论 nextTick 和修改数据的顺序如何，nextTick都会拿到最新的 dom 内容</p>
<p>那么 setTimeout 包裹后，<code>微任务的执行顺序</code>和 <code>代码中的顺序一致</code>。</p>
<p>看如下代码:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;box&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>    &#123;&#123;a&#125;&#125;,&#123;&#123;b&#125;&#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">	<span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-comment">// setTimeout 内部，DOM的异步更新方法和 nextTick 回调方法跟代码的顺序一致</span></span><br><span class="language-javascript">      <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">box</span>.<span class="hljs-property">innerHTML</span>) <span class="hljs-comment">// 1, 2</span></span><br><span class="language-javascript">      &#125;)</span><br><span class="language-javascript">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span> = <span class="hljs-number">4</span></span><br><span class="language-javascript">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = <span class="hljs-number">3</span></span><br><span class="language-javascript">    &#125;, <span class="hljs-number">2000</span>)</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">  <span class="hljs-title function_">beforeUpdate</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;beforeUpdate &#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>)</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;beforeUpdate &#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span>)</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">  <span class="hljs-title function_">updated</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;updated &#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>)</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;updated &#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span>)</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="怪异的-setTimeout"><a href="#怪异的-setTimeout" class="headerlink" title="怪异的 setTimeout"></a>怪异的 setTimeout</h2><p>如果不加 <code>setTimeout</code> 包裹，<code>nextTick</code> 永远都是在 <code>updated</code> 钩子之后执行，所以无论设置状态的操作和 nextTick 之间的顺序是什么，nextTick 都能拿到最新的 DOM 内容。</p>
<p>但是加了 setTimeout 就不一样了。</p>
<p>当 <code>this.a</code> 在 <code>this.$nextTick</code> 之前时，nextTick 能够拿到最新的 DOM。<code>这个时候，更新 dom 的异步方法先进队列，然后是 beforeUpdate、updated。最后是 nextTick 回调函数进入队列</code>，所以先执行了 <code>更新DOM的异步方法</code>，再执行了 <code>nextTick callback</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = <span class="hljs-number">3</span><br>  <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">box</span>.<span class="hljs-property">innerHTML</span>) <span class="hljs-comment">// 3, 4</span><br>  &#125;)<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span> = <span class="hljs-number">4</span><br>&#125;, <span class="hljs-number">2000</span>)<br></code></pre></td></tr></table></figure>

<p>当 <code>this.a</code> 在 <code>this.$nextTick</code> 之后时，nextTick 会比 <code>DOM的更新操作</code> 先执行。这是因为 <code>nextTick callback</code> 先进入队列，<code>DOM的更新操作</code>紧随其后，然后是 <code>beforeUpdate、updated</code>。所以先执行了 <code>nextTick callback</code>，从而拿不到最新的 DOM。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">box</span>.<span class="hljs-property">innerHTML</span>) <span class="hljs-comment">// 1, 2</span><br>  &#125;)<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = <span class="hljs-number">3</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span> = <span class="hljs-number">4</span><br>&#125;, <span class="hljs-number">2000</span>)<br></code></pre></td></tr></table></figure>

<h1 id="如何提高前端页面的加载速度？"><a href="#如何提高前端页面的加载速度？" class="headerlink" title="如何提高前端页面的加载速度？"></a>如何提高前端页面的加载速度？</h1><ol>
<li><p>使用路由懒加载、异步组件，实现组件模块的拆分，减少入口文件体积大小</p>
</li>
<li><p>抽离公共代码，采用 splitChunks 进行代码分割</p>
</li>
<li><p>组件加载、脚本模块采用按需加载的方式（<code>import 方法</code>）</p>
</li>
<li><p>浏览器缓存策略（HTTP强缓存、协商缓存），缓存静态资源</p>
</li>
<li><p>图片资源的亚索，雪碧图、对小图片采用 base64 减少 HTTP 请求</p>
</li>
<li><p>打包时开启 gzip 压缩处理，<code>compress-webpack-plugin</code></p>
<p>使用 swc 、esbuild 压缩，提升构建效率</p>
<p>使用 swc 压缩代码，需要安装 @swc/core 包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">optimization</span>: &#123;<br>  <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开发环境下启用 JS、CSS 优化</span><br>  <span class="hljs-attr">minimizer</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>(&#123;<br>    <span class="hljs-attr">minify</span>: <span class="hljs-title class_">TerserWebpackPlugin</span>.<span class="hljs-property">swcMinify</span>,<br>    <span class="hljs-attr">terserOptions</span>: &#123;&#125;<br>  &#125;), <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>()],<br>  <span class="hljs-attr">splitChunks</span>: &#123;<br>    <span class="hljs-attr">cacheGroups</span>: &#123;<br>      <span class="hljs-attr">styles</span>: &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;styles&quot;</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;css/mini-extract&quot;</span>,<br>        <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>        <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,<br>      &#125;,<br>    &#125;,<br>    <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span><br>  &#125;,<br>&#125;,<br></code></pre></td></tr></table></figure>
</li>
<li><p>静态资源采用 CDN 提速</p>
</li>
</ol>


  
</article>

              </div>
            </div>
          </div>
        </div>
      </div>
    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hello-alex-cheng.github.io/" target="_blank" rel="nofollow noopener"><span>I</span></a> <i class="iconfont icon-love"></i> <a href="https://hello-alex-cheng.github.io/" target="_blank" rel="nofollow noopener"><span>YOU</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
